# Copyright (c) 2025 TESOBE
#
# This file is part of OBP-OIDC.
#
# OBP-OIDC is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# OBP-OIDC is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with OBP-OIDC. If not, see <http://www.gnu.org/licenses/>.

# ============================================================================
# OBP-OIDC Environment Configuration Template
# ============================================================================
# Copy this file to .env and edit with your actual values
# DO NOT commit .env to version control - it contains sensitive data!
#
# Usage: cp .env.example .env && edit .env
# ============================================================================

# ----------------------------------------------------------------------------
# Server Configuration
# ----------------------------------------------------------------------------
OIDC_HOST=localhost
OIDC_PORT=9000
OIDC_KEY_ID=oidc-key-1

# External URL Configuration (for production with reverse proxy/load balancer)
# IMPORTANT: Set this when deploying behind a reverse proxy or using a custom domain
# This determines the issuer URL in the OIDC discovery document and JWT tokens
#
# Examples:
#   OIDC_EXTERNAL_URL=https://test-oidc.openbankproject.com
#   OIDC_EXTERNAL_URL=https://oidc.mycompany.com
#   OIDC_EXTERNAL_URL=https://auth.example.com
#
# If not set, falls back to: http://OIDC_HOST:OIDC_PORT
# Note: Do NOT include trailing slash or /obp-oidc path (added automatically)
#OIDC_EXTERNAL_URL=https://test-oidc.openbankproject.com

# Token expiration in seconds
# 3600 = 1 hour, 28800 = 8 hours, 300 = 5 minutes
OIDC_TOKEN_EXPIRATION=28800

# Authorization code expiration in seconds
OIDC_CODE_EXPIRATION=600

# ----------------------------------------------------------------------------
# OBP-API Configuration
# ----------------------------------------------------------------------------
OBP_API_HOST=localhost:8080
OBP_API_URL=http://localhost:8080

# ----------------------------------------------------------------------------
# Credential Verification Method
# ----------------------------------------------------------------------------
# Choose how user credentials are verified:
#   v_oidc_users              - (default) Verify against the v_oidc_users database view
#   verify_credentials_endpoint - Verify via OBP API endpoint POST /obp/v6.0.0/users/verify-credentials
#
# When using verify_credentials_endpoint, you must also provide:
#   - OBP_API_URL (above)
#   - OBP_API_USERNAME (a user with CanVerifyUserCredentials role)
#   - OBP_API_PASSWORD (password for the above user)
#   - OBP_API_CONSUMER_KEY (consumer key for DirectLogin authentication)
VERIFY_CREDENTIALS_METHOD=v_oidc_users

# ----------------------------------------------------------------------------
# Client Verification Method
# ----------------------------------------------------------------------------
# Choose how OIDC clients are verified:
#   v_oidc_clients          - (default) Verify against the v_oidc_clients database view
#   verify_client_endpoint  - Verify via OBP API endpoint POST /obp/v6.0.0/oidc/clients/verify
#
# When using verify_client_endpoint, you must also provide:
#   - OBP_API_URL (above)
#   - OBP_API_USERNAME (a user with CanVerifyOidcClient role)
#   - OBP_API_PASSWORD (password for the above user)
#   - OBP_API_CONSUMER_KEY (consumer key for DirectLogin authentication)
VERIFY_CLIENT_METHOD=v_oidc_clients

# ----------------------------------------------------------------------------
# OBP API Authentication (for API-based verification methods)
# ----------------------------------------------------------------------------
# Required when using verify_credentials_endpoint or verify_client_endpoint
#OBP_API_USERNAME=admin_user
#OBP_API_PASSWORD=admin_password
#OBP_API_CONSUMER_KEY=your_consumer_key_here

# ----------------------------------------------------------------------------
# Client Bootstrap Configuration
# ----------------------------------------------------------------------------
# Set to 'true' to skip automatic client creation on startup
OIDC_SKIP_CLIENT_BOOTSTRAP=false

# ----------------------------------------------------------------------------
# Database Configuration (Read-Only User)
# ----------------------------------------------------------------------------
# IMPORTANT: Edit these values for your database setup
DB_HOST=localhost
DB_PORT=5432
DB_NAME=sandbox
OIDC_USER_USERNAME=oidc_user
OIDC_USER_PASSWORD=CHANGE_THIS_PASSWORD
DB_MAX_CONNECTIONS=10

# ----------------------------------------------------------------------------
# Admin Database Configuration (Write Access)
# ----------------------------------------------------------------------------
# IMPORTANT: This user has write access to manage OIDC clients
OIDC_ADMIN_USERNAME=oidc_admin
OIDC_ADMIN_PASSWORD=CHANGE_THIS_ADMIN_PASSWORD
DB_ADMIN_MAX_CONNECTIONS=5

# ----------------------------------------------------------------------------
# OBP Ecosystem Client Configuration
# ----------------------------------------------------------------------------
# NOTE: OIDC clients are automatically created on first server startup!
# The server will generate secure client IDs and secrets automatically.
#
# Client configurations are hardcoded in the application and include:
#   - obp-api-client (for OBP-API)
#   - obp-portal-client (for Portal)
#   - obp-explorer-ii-client (for Explorer II)
#   - obp-opey-ii-client (for Opey II)
#   - obp-api-manager-ii (for API Manager II)
#   - obp-stripe (for Stripe integration)
#   - other-app-1, other-app-2, other-app-3, other-app-4 (for custom apps)
#
# To customize redirect URLs, modify the ClientBootstrap.scala file.
# After first run, copy the generated client configurations from server output
# to your client applications (OBP-API Props file, Portal env, etc.)

# ----------------------------------------------------------------------------
# Development Mode
# ----------------------------------------------------------------------------
LOCAL_DEVELOPMENT_MODE=true

# ----------------------------------------------------------------------------
# Logo Configuration (Optional)
# ----------------------------------------------------------------------------
# The OBP logo displays by default. Uncomment and change to use a custom logo.
# To disable the logo entirely, set LOGO_URL to an empty string: LOGO_URL=""
#LOGO_URL=https://static.openbankproject.com/images/OBP/OBP_Horizontal_2025.png
#LOGO_ALT_TEXT=Open Bank Project

# ----------------------------------------------------------------------------
# Logging Configuration
# ----------------------------------------------------------------------------
# Set to 'true' to enable TRACE level logging for detailed debugging
# Usage: OIDC_ENABLE_TRACE_LOGGING=true ./run-server.sh
OIDC_ENABLE_TRACE_LOGGING=false

# ----------------------------------------------------------------------------
# Cats Effect Configuration
# ----------------------------------------------------------------------------
# Silence the threading warning
CATS_EFFECT_WARN_ON_NON_MAIN_THREAD_DETECTED=false


OBP_PORTAL_BASE_URL=http://localhost:5174/
